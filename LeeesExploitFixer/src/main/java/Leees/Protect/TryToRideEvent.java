package Leees.Protect;

import org.bukkit.Bukkit;
import org.bukkit.ChatColor;
import org.bukkit.Location;
import org.bukkit.Material;
import org.bukkit.World;
import org.bukkit.block.Block;
import org.bukkit.entity.Entity;
import org.bukkit.entity.EntityType;
import org.bukkit.event.EventHandler;
import org.bukkit.event.EventPriority;
import org.bukkit.event.Listener;
import org.bukkit.event.entity.EntityPortalEvent;

import com.destroystokyo.paper.event.entity.EntityTeleportEndGatewayEvent;

public class TryToRideEvent implements Listener {
    @EventHandler(priority = EventPriority.HIGHEST)
    public void onClick(EntityTeleportEndGatewayEvent event) {
        Entity entity = event.getEntity();
        int x = event.getFrom().getBlockX();
        int y = event.getFrom().getBlockY();
        int z = event.getFrom().getBlockZ();
        Location from = event.getFrom();
        World world = event.getFrom().getWorld();
        event.getFrom().getBlock().setType(Material.AIR);
        event.setTo(from);
        Bukkit.dispatchCommand(Bukkit.getConsoleSender(), "execute @e[type=" + entity.getType()+ "] "+ x +" "+ y +" "+ z +" minecraft:kill @e[type=player,r=2]");
        Bukkit.dispatchCommand(Bukkit.getConsoleSender(), "execute @e[type=item] "+ x +" "+ y +" "+ z +" minecraft:kill @e[type=player,r=2]");
        System.out.println(ChatColor.translateAlternateColorCodes('&', "&1Prevented&r&e "+ entity.getType() +" at " + x + " " + y + " " + z + " &r&1in world&e " + world.getName() + " &r&1from teleporting"));
    }
    @EventHandler
    public void EntityPortalEvent(EntityPortalEvent event) {
        Entity entity = event.getEntity();
        Block block = event.getFrom().getBlock();
        int x = event.getFrom().getBlockX();
        int y = event.getFrom().getBlockY();
        int z = event.getFrom().getBlockZ();
        World world = event.getFrom().getWorld();
        if (entity.getType() == EntityType.DROPPED_ITEM ||
                entity.getType() == EntityType.ARMOR_STAND ||
                entity.getType() == EntityType.MINECART ||
                entity.getType() == EntityType.BOAT ||
                entity.getType() == EntityType.FALLING_BLOCK ||
                entity.getType() == EntityType.EGG)
            event.setCancelled(true);
        if (entity.getType() == EntityType.DROPPED_ITEM ||
                entity.getType() == EntityType.ARMOR_STAND ||
                entity.getType() == EntityType.MINECART ||
                entity.getType() == EntityType.BOAT ||
                entity.getType() == EntityType.FALLING_BLOCK ||
                entity.getType() == EntityType.EGG && block.getType() == Material.PORTAL || block
                .getType() == Material.END_GATEWAY)
            System.out.println(ChatColor.translateAlternateColorCodes('&', "&1Prevented&r&e "+ entity.getName() +" at " + x + " " + y + " " + z + " &r&1in world&e " + world.getName() + " &r&1from going through a &r&e"+ block.getType() +"&r"));
    }
}

