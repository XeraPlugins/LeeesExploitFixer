package Leees.Protect;

import java.io.BufferedReader;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileReader;
import java.util.ArrayList;
import java.util.List;
import java.util.UUID;

import org.bukkit.*;
import org.bukkit.entity.Player;
import org.bukkit.event.EventHandler;
import org.bukkit.event.Listener;
import org.bukkit.event.block.BlockDispenseEvent;
import org.bukkit.event.block.BlockPlaceEvent;
import org.bukkit.event.player.*;
import org.bukkit.plugin.java.JavaPlugin;

public class Main extends JavaPlugin implements Listener {
    public static List canCreative = new ArrayList();

    public void onEnable() {
        this.getCommand("allowcreative").setExecutor(new AllowCreative());

        try {
            BufferedReader br = new BufferedReader(new FileReader(new File("plugins/LeeesExploitFixer/canusecreative.txt")));
            br.lines().forEach((s) -> {
                canCreative.add(UUID.fromString(s));
            });
        } catch (FileNotFoundException var2) {
            var2.printStackTrace();
        }
        FileUtils.save(new File("plugins/LeeesExploitFixer"));
        Bukkit.getServer().getPluginManager().registerEvents(this, this);
        Bukkit.getServer().getPluginManager().registerEvents(new TryToRideEvent(), this);
        Bukkit.getServer().getPluginManager().registerEvents(new HandSwapEvent(), this);
        Bukkit.getServer().getPluginManager().registerEvents(new Book(), this);
        Bukkit.getServer().getPluginManager().registerEvents(new Playerlogin(), this);
    }


    @EventHandler
    public void dispenseEvent(BlockDispenseEvent event) {
        if (event.getBlock().getType() == Material.DISPENSER) {
            if (event.getItem().getType() == Material.MONSTER_EGG) {
                event.setCancelled(true);
            }

            if (event.getItem().getType() == Material.MINECART) {
                event.setCancelled(true);
            }

            if (event.getItem().getType() == Material.STORAGE_MINECART) {
                event.setCancelled(true);
            }

            if (event.getItem().getType() == Material.EXPLOSIVE_MINECART) {
                event.setCancelled(true);
            }

            if (event.getItem().getType() == Material.HOPPER_MINECART) {
                event.setCancelled(true);
            }

            if (event.getItem().getType() == Material.POWERED_MINECART) {
                event.setCancelled(true);
            }

            if (event.getItem().getType() == Material.COMMAND_MINECART) {
                event.setCancelled(true);
            }

            if (event.getItem().getType() == Material.BOAT) {
                event.setCancelled(true);
            }

            if (event.getItem().getType() == Material.BOAT_ACACIA) {
                event.setCancelled(true);
            }

            if (event.getItem().getType() == Material.BOAT_BIRCH) {
                event.setCancelled(true);
            }

            if (event.getItem().getType() == Material.BOAT_DARK_OAK) {
                event.setCancelled(true);
            }

            if (event.getItem().getType() == Material.BOAT_JUNGLE) {
                event.setCancelled(true);
            }

            if (event.getItem().getType() == Material.BOAT_SPRUCE) {
                event.setCancelled(true);
            }

        }

    }

    @EventHandler
    public void onGamemodeChange(PlayerGameModeChangeEvent event) {
        if (!event.getPlayer().isOp() && !canCreative.contains(event.getPlayer().getUniqueId())) {
            event.getPlayer().setGameMode(GameMode.SURVIVAL);
            event.setCancelled(true);
        }

    }

    @EventHandler
    public void onBlockPlace(BlockPlaceEvent event) {
        Player player = event.getPlayer();

        if (event.getBlock().getType() == Material.BEDROCK) {
            event.setCancelled(true);
        }
        if (event.getBlock().getType() == Material.BARRIER) {
            event.setCancelled(true);
        }
        if (event.getBlock().getType() == Material.ENDER_PORTAL_FRAME) {
            event.setCancelled(true);
        }
        if (event.getBlock().getType() == Material.MOB_SPAWNER) {
            event.setCancelled(true);
        }
        if (event.getBlock().getType() == Material.COMMAND) {
            event.setCancelled(true);
        }
        if (event.getBlock().getType() == Material.COMMAND_CHAIN) {
            event.setCancelled(true);
        }
        if (event.getBlock().getType() == Material.COMMAND_REPEATING) {
            event.setCancelled(true);
        }
        if (event.getBlock().getType() == Material.STRUCTURE_BLOCK) {
            event.setCancelled(true);
        }
        if (event.getBlock().getType() == Material.STRUCTURE_VOID) {
            event.setCancelled(true);
        }
        if (player.getInventory().getItemInMainHand().getType() == Material.SKULL_ITEM && player
                .getInventory().getItemInMainHand().getDurability() == 3) {
            event.setCancelled(true);
        }
        if (player.getInventory().getItemInOffHand().getType() == Material.SKULL_ITEM && player
                .getInventory().getItemInOffHand().getDurability() == 3) {
            event.setCancelled(true);
        }

    }

    public void onDisable() {
    }
}
